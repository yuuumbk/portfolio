'use strict'; $(function () { $('a[target="_blank"]').has('img').addClass('remove-icon'); var hashList = ['service', 'about', 'skills', 'works', 'contact',]; if (location.hash.length) { var locationHash = location.hash, locationHashFlag = !1; history.replaceState('', document.title, location.pathname); setTimeout(function () { $.each(hashList, function (i) { if (locationHash === '#' + hashList[i]) { locationHashFlag = !0; return !1 } }); if (locationHashFlag) { $('html, body').scrollTop($(locationHash).offset().top - $('#header').outerHeight() * 2.2) } else { $('html, body').scrollTop(0) } }, 50) } var humBtn = '.mb .ham-btn', $link = $('.mb .menu .list .list-item a'); $(humBtn).on('click', function () { $('.menu, .ham-btn-line').toggleClass('open') }); $(document).on('click', function (e) { var $target = $(e.target); if (!$target.closest(humBtn).length && !$target.filter('.external-page').length) { $('.menu, .ham-btn-line').removeClass('open') } }); $('.rain').raindrops({ color: '#444', waveLength: 400, frequency: 5, waveHeight: 80, density: 0, rippleSpeed: 0.002, canvasWidth: 2000, canvasHeight: 100, positionBottom: 0, positionLeft: 0 }); $('.scroll-fadein').each(function () { $(this).addClass('invisible') }); var windowHeight = $(window).height(); $(window).on('scroll', $.throttle(200, function () { scroll() })).delay(600).trigger('scroll'); function scroll() { $('.scroll-fadein').each(function () { var $scrollFadeIn = $(this), scrollFadeInOffset = $scrollFadeIn.offset().top; fadeIn(); function fadeIn() { var scrollAmount = $(window).scrollTop(); if (scrollAmount > scrollFadeInOffset - windowHeight + 30) { $scrollFadeIn.addClass('scrollin') } else if (scrollAmount <= scrollFadeInOffset - windowHeight) { $scrollFadeIn.removeClass('scrollin') } } }) } var $toTop = $('.to-top'); $toTop.hide(); var windowHeight = $(window).height(); $(window).on('scroll', $.throttle(200, function () { if ($(this).scrollTop() >= windowHeight) { $toTop.fadeIn(500) } else { $toTop.fadeOut(500) } })); var smooth = ['down-allow',]; var smoothTo = ['top', 'service', 'about', 'skills', 'works', 'contact',]; $.each(smooth, function (i, val) { smoothScroll('.' + val) }); $.each(smoothTo, function (i, val) { smoothScroll('.to-' + val) }); function smoothScroll(target, offset = 150, duration = 800, easing = 'easeInOutCirc') { $(target).find('a').on('click', function (e) { if ($(this).filter('.external-page').length) { return } e.preventDefault(); var target = this.hash, $target = $(target); $('html, body').stop().animate({ 'scrollTop': $target.offset().top - offset, }, duration, easing) }) } var verificationOptions = { rules: { name: { required: !0, }, email: { required: !0, email: !0, }, type: { required: !0, }, content: { required: !0, } }, messages: { name: { required: 'お名前が未入力です。', }, email: { required: 'メールアドレスが未入力です。', email: 'メールアドレスが正しくありません。', }, type: { required: 'お問い合わせ種別が未選択です。', }, content: { required: 'お問い合わせ内容が未入力です。', } }, errorPlacement: function (error, element) { error.appendTo(element.data('error_placement')) } }; var $contactFormName = $('#contact-form-name'), $contactFormEmail = $('#contact-form-email'), $contactFormType = $('.contact-form-type'), $contactFormContent = $('#contact-form-content'), $contactFormSubmit = $('.contact-form-submit'), $contactFormSubmitMessage = $contactFormSubmit.next(); $('.contact-form').validate(verificationOptions); $contactFormName.add($contactFormContent).each(function () { $(this).keyup(function () { if ($(this).valid()) { $(this).css({ border: '1px solid #65ab31', }) } else { $(this).css({ border: '1px solid #ea5550', }) } }); $(this).blur(function () { if ($(this).valid()) { $(this).css({ border: '1px solid #65ab31', }) } else { $(this).css({ border: '1px solid #ea5550', }) } }) }); $contactFormEmail.each(function () { $(this).blur(function () { if ($(this).valid()) { $(this).css({ border: '1px solid #65ab31', }) } else { $(this).css({ border: '1px solid #ea5550', }) } }) }); var typeChanged = !1; $contactFormType.each(function () { $(this).change(function () { $('style').html('.contact-form-underline:after {background-color: #65ab31 !important;}'); typeChanged = !0 }) }); var submitFlag = !1; $contactFormSubmit.on('click', function (e) { e.preventDefault(); $('.contact-form').validate(verificationOptions); var validationFlag = !0; if (!$contactFormName.valid()) { $contactFormName.css({ border: '1px solid #ea5550', }); validationFlag = !1 } if (!$contactFormEmail.valid()) { $contactFormEmail.css({ border: '1px solid #ea5550', }); validationFlag = !1 } if (!$contactFormContent.valid()) { $contactFormContent.css({ border: '1px solid #ea5550', }); validationFlag = !1 } if (!typeChanged) { $('style').html('.contact-form-underline:after {background-color: #ea5550 !important;}') } if (!$('.contact-form').valid()) { validationFlag = !1 } if (submitFlag) { $contactFormSubmitMessage.css({ opacity: 1, }).html('一度に複数のお問い合わせはお控えください。'); return } else if (!validationFlag) { $contactFormSubmitMessage.css({ opacity: 1, }).html('入力内容を確認してもう一度送信してください。'); return } var name = $contactFormName.val(), email = $contactFormEmail.val(), type = $('.contact-form-type:checked').val(), message = $contactFormContent.val(); $.ajax({ url: "https://formspree.io/f/xknkorgp", method: "POST", dataType: "json", data: { お名前: name, メールアドレス: email, お問い合わせ種別: type, お問い合わせ内容: message, } }); submitFlag = !0; $contactFormSubmitMessage.css({ opacity: 1, }).html('送信が完了しました。<br>お問い合わせありがとうございます。') }) })